<!doctype html>
<html>

<head>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.css">
    <script src="/utils_CC.js"></script>
</head>

<body>
    <div style="width:400px">
        <canvas id="canvas"></canvas>
    </div>
    <script>
        const opt = {
            pointBorderWidth: 0,
            pointRadius: 7,
            labelFontSize: 9
        }
        const datasetColors = {

                "aspirer": ["#78a841", "#a0cc3b", "#b9d76d", "#a6a5a5", "#858585", "#626363"],
                "adventurer": ["#23a77c", "#56c09a", "#7bcab2", "#a6a5a5", "#858585", "#626363"],
                "ambassador": ["#1d78a8", "#2c9dd7", "#68b8e4", "#a6a5a5", "#858585", "#626363"],
                "architect": ["#2e3896", "#4450a2", "#6668b0", "#a6a5a5", "#858585", "#626363"],
                "advocate": ["#773595", "#894f9f", "#a16faf", "#a6a5a5", "#858585", "#626363"],
                "activator": ["#a72022", "#da3131", "#e36b69", "#a6a5a5", "#858585", "#626363"]

            }
            //FOR URL: ?options={"aspirer":{"x":3,"y":-3},"adventurer":{"x":3,"y":6},"ambassador":{"x":1,"y":-3.1},"architect":{"x":-4,"y":-5.4},"advocate":{"x":5.3,"y":-2.1},"activator":{"x":-4.2,"y":6.2}}
        const data2 = {

            "aspirer": {
                "x": 2,
                "y": -3
            },
            "adventurer": {
                "x": 6,
                "y": 6
            },
            "ambassador": {
                "x": 1,
                "y": -3.1
            },
            "architect": {
                "x": -4,
                "y": -5.4
            },
            "advocate": {
                "x": 5.3,
                "y": -2.1
            },
            "activator": {
                "x": -4.2,
                "y": 6
            }

        }
        const searchParams = new URLSearchParams(window.location.search)

        const data = JSON.parse(searchParams.get('options')) || data2

        const dataset = [{
            label: 'ASPIRER',
            // borderColor: window.chartColors.red,
            backgroundColor: datasetColors.aspirer[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,
            data: [data.aspirer]
        }, {
            label: 'ADVENTURER',
            // borderColor: window.chartColors.blue,
            backgroundColor: datasetColors.adventurer[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,

            data: [data.adventurer]
        }, {
            label: 'AMBASSADOR',
            // borderColor: window.chartColors.blue,
            backgroundColor: datasetColors.ambassador[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,

            data: [data.ambassador]
        }, {
            label: 'ARCHITECT',
            // borderColor: window.chartColors.blue,
            backgroundColor: datasetColors.architect[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,

            data: [data.architect]
        }, {
            label: 'ADVOCATE',
            // borderColor: window.chartColors.blue,
            backgroundColor: datasetColors.advocate[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,

            data: [data.advocate]
        }, {
            label: 'ACTIVATOR',
            // borderColor: window.chartColors.blue,
            backgroundColor: datasetColors.activator[0],
            pointRadius: opt.pointRadius,
            pointBorderWidth: opt.pointBorderWidth,

            data: [data.activator]
        }]
        var color = Chart.helpers.color;
        Chart.defaults.global.elements.point.pointRadius = 5

        function generateData() {
            var data = [];
            for (var i = 0; i < 7; i++) {
                data.push({
                    x: randomScalingFactor(),
                    y: randomScalingFactor()
                });
            }
            return data;
        }

        var scatterChartData = {
            datasets: dataset
        };

        window.onload = function() {
            var ctx = document.getElementById('canvas').getContext('2d');
            window.myScatter = Chart.Scatter(ctx, {
                data: scatterChartData,
                options: {
                    //custom labels Options 
                    animation: {
                        duration: 0,
                        onComplete: function() {
                            var chartInstance = this.chart,
                                ctx = chartInstance.ctx;
                            ctx.font = Chart.helpers.fontString(opt.labelFontSize, "bold", Chart.defaults.global.defaultFontFamily);
                            ctx.textAlign = 'center';

                            ctx.textBaseline = 'bottom';

                            this.data.datasets.forEach(function(dataset, i) {
                                var meta = chartInstance.controller.getDatasetMeta(i);
                                meta.data.forEach(function(bar, index) {
                                    var data = dataset.label;
                                    ctx.fillStyle = dataset.backgroundColor;
                                    let x = bar._model.x + 1;
                                    let y = bar._model.y;
                                    console.log("y=" + y)
                                    if (x < 66) {
                                        x = x + 30
                                    }
                                    if (x > 360 & x < 390) {
                                        x = x - 20
                                    }
                                    if (x > 390) {
                                        x = x - 35
                                    }
                                    if (y < 20) {
                                        y = y + 35
                                    }

                                    ctx.fillText(data, x, y - 10);
                                });
                            });
                        }
                    },
                    //custom labels
                    "responsive": true,
                    "maintainAspectRatio": true,
                    "responsiveAnimationDuration": 0,
                    "legend": {
                        "display": false
                    },
                    aspectRatio: 1,
                    title: {
                        display: false,
                        text: 'Chart.js Scatter Chart'
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                suggestedMin: -6,
                                suggestedMax: 6,
                                display: false,
                                // maxTicksLimit: 6,
                                "beginAtZero": true,
                            },
                            "gridLines": {
                                "offsetGridLines": false,
                                "display": true,
                                drawBorder: false,
                                lineWidth: 1,
                                drawOnChartArea: true,
                                drawTicks: false,
                                zeroLineBorderDashOffset: 0,
                                zeroLineWidth: 2,
                                zeroLineColor: "grey",
                                offsetGridLines: false,
                                z: 0,
                                color: "grey"
                            }
                        }],
                        xAxes: [{
                            ticks: {
                                suggestedMin: -6,
                                suggestedMax: 6,
                                display: false,
                                // maxTicksLimit: 6,
                                "beginAtZero": true,
                            },
                            "gridLines": {
                                "offsetGridLines": false,
                                "display": true,
                                drawBorder: false,
                                lineWidth: 1,
                                drawOnChartArea: true,
                                drawTicks: false,
                                zeroLineBorderDashOffset: 5,
                                zeroLineWidth: 2,
                                zeroLineColor: "grey",
                                offsetGridLines: false,
                                z: 0,
                                color: "grey"
                            }
                        }]
                    }
                }
            });
        };
        console.log(Chart.defaults.global)
    </script>
</body>

</html>